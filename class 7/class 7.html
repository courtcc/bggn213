<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Courtney Cameron PID">

<title>Class 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="class 7_files/libs/clipboard/clipboard.min.js"></script>
<script src="class 7_files/libs/quarto-html/quarto.js"></script>
<script src="class 7_files/libs/quarto-html/popper.min.js"></script>
<script src="class 7_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="class 7_files/libs/quarto-html/anchor.min.js"></script>
<link href="class 7_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="class 7_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="class 7_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="class 7_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="class 7_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 7</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Courtney Cameron PID </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>#Machine Learning methods using clustering and dimensionality reduction approaches</p>
<p>#Kmeans clustering</p>
<p>the main function for k-means in base R is kmeans()</p>
<p>using made up data to determine how kmeans works and to look at how the results are given</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>make a vector with 60 points, half centered at +3 and half centered at -3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">3</span>),<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tmp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3.2966247  4.2141052  3.2469535  1.4960021  5.6146806  3.7795424
 [7]  2.7399422  3.0231632  3.4546803  1.4358585  4.5680097  3.2465524
[13]  3.4587671  2.2353531  2.2766838  0.8177223  3.7676942  3.0330039
[19]  2.0486185  2.1822564  3.4843838  3.4944162  3.8300703  2.7136936
[25]  3.9331909  2.6469526  1.9566494  1.8985658  3.8273992  2.3639014
[31] -2.2669056 -0.8966891 -1.7292412 -3.1851299 -5.8741093 -3.0631853
[37] -3.7888205 -3.6535917 -1.5413589 -4.8225098 -4.5478687 -1.9335344
[43] -2.4285014 -2.3554738 -3.3671420 -3.5313557 -0.7290590 -1.2209063
[49] -2.7054467 -1.9271298 -3.5325731 -2.1835202 -2.9854798 -2.1465216
[55] -4.4221092 -3.9339107 -3.7712839 -2.4792770 -3.8944868 -2.0396747</code></pre>
</div>
</div>
<p>make a scatter plot of tmp</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>rev_tmp <span class="ot">&lt;-</span> <span class="fu">rev</span>(tmp)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tmp, rev_tmp)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>find kmeans of tmp_df</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers=</span><span class="dv">2</span>, <span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
        tmp   rev_tmp
1  3.002848 -2.898560
2 -2.898560  3.002848

Clustering vector:
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 72.93062 72.93062
 (between_SS / total_SS =  87.7 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>What is in the result object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      

$class
[1] "kmeans"</code></pre>
</div>
</div>
<p>Whar are the cluster centers</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>k<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        tmp   rev_tmp
1  3.002848 -2.898560
2 -2.898560  3.002848</code></pre>
</div>
</div>
<p>what is the clustering results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>k<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q Plot your data ‘x’ showing your clustering results and the center point for each cluster?&lt;</p>
</blockquote>
<p>‘points’ can be used to add additional chuncks - will add points to the previosly exsisting grph with no ‘+’ like in ggplot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>k<span class="sc">$</span>cluster) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k<span class="sc">$</span>centers, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">col=</span><span class="st">'green'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q. run kmeans and cluster in 3 groups and plot the results?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>k2<span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">20</span> )</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>k2<span class="sc">$</span>cluster)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k2<span class="sc">$</span>centers, <span class="at">pch=</span><span class="dv">15</span>, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>a greater number of centers yeilds a lower sum of squares</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>k<span class="sc">$</span>tot.withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 145.8612</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>k2<span class="sc">$</span>tot.withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 115.8429</code></pre>
</div>
</div>
<p>The major limitation of kmeans is that it imposes structure on the data, it will cluster based on the number of groups specified regardless if that is the best structure</p>
<p>#Hierarchical Clusterin hclust() doesn’t want the data, it was a distance matrix found by dist() in base R dist() measures euclidian distance by default - symetrical matrix the determines distance between all values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            1          2          3          4          5          6          7
2   2.0693232                                                                  
3   0.4423996  1.7141182                                                       
4   2.4981417  2.7208939  2.1760314                                            
5   2.9935786  1.4011302  2.7788650  4.1218879                                 
6   2.4308853  0.6835424  2.0145093  2.3744746  1.8989655                      
7   0.5668436  2.2865998  0.6064541  2.0462745  3.3850968  2.5018128           
8   0.9845448  1.4982112  0.5534649  1.7174717  2.7596166  1.6235805  0.8854744
9   0.2137126  1.8719329  0.3614173  2.5213912  2.7801921  2.2620380  0.7156950
10  2.3856229  2.8017203  2.0951129  0.2461708  4.1980503  2.5068165  1.9030957
11  1.2763566  1.9989353  1.4318016  3.5830343  2.2633360  2.6166014  1.8411853
12  0.6676523  1.5329628  0.2261701  2.0494964  2.6677996  1.7975006  0.7543548
13  0.8346688  2.7782312  1.2760728  3.2182096  3.4653075  3.2172343  1.1719527
14  1.6864195  3.7330139  2.0215337  3.1307782  4.6573521  4.0028915  1.5045964
15  1.8070395  1.9711585  1.4311859  0.8167187  3.3621828  1.7470048  1.4602650
16  2.8119613  3.4370786  2.5864007  0.7895531  4.8303246  3.1440951  2.2770252
17  0.5671292  1.6024493  0.5352551  2.6767710  2.4295723  2.0666693  1.0487779
18  0.4697682  1.8825816  0.2198923  2.0409408  2.9885301  2.1288005  0.4066912
19  1.2525116  2.9214153  1.3167543  1.9190384  4.0888023  3.0313532  0.7233893
20  2.7446045  2.1343190  2.3265106  1.0363536  3.4869013  1.6022291  2.4652548
21  2.7891620  1.1805592  2.3552310  2.2491637  2.3081969  0.4974327  2.7776080
22  0.5361344  2.4607241  0.9700145  2.9943654  3.1968461  2.8948263  0.9671882
23  1.6997918  0.4533357  1.3111218  2.3370336  1.8064918  0.7701767  1.8600106
24  1.8437244  1.5041278  1.4139556  1.2178177  2.9046131  1.2397936  1.6425086
25  1.2053176  0.8774822  0.9010387  2.5379702  1.8935602  1.3675825  1.5046976
26  3.8890825  2.5248510  3.4474465  2.3971987  3.5456707  1.8414842  3.7287473
27  1.7628390  2.3662828  1.4707526  0.7455015  3.7338807  2.2029655  1.3008669
28  1.4321096  3.1701753  1.5429528  2.0813448  4.3208885  3.2847544  0.9391684
29  1.2602133  3.0226367  1.6856754  3.7011765  3.5240729  3.5257448  1.6566967
30  0.9600035  2.4641987  0.9082306  1.7367796  3.6532823  2.5785543  0.3948405
31  7.0953753  9.0094907  7.3388704  7.1972198 10.0886985  9.0889753  6.7388753
32  7.2115489  9.2600077  7.5461208  7.9664896 10.1309362  9.4826963  6.9937699
33  6.3850658  8.2995677  6.6278217  6.5229893  9.3782178  8.3843681  6.0279625
34  7.6147061  9.4331582  7.8133949  7.3974466 10.5893986  9.4443221  7.2071139
35 10.2988755 12.0234147 10.4628876  9.7730395 13.2400927 11.9651421  9.8579551
36  8.7248099 10.6879136  8.9965325  8.9523808 11.7130972 10.7997205  8.4047126
37  8.5321770 10.3785774  8.7446589  8.3656609 11.5159227 10.4019132  8.1391913
38  9.0972202 11.0258532  9.3501544  9.1814434 12.0905034 11.1063022  8.7519671
39  7.3506631  9.3659626  7.6559092  7.8750213 10.3145015  9.5385200  7.0816466
40  9.8201613 11.6665394 10.0340166  9.6212425 12.8049224 11.6836609  9.4285617
41  8.9084667 10.6629730  9.0823535  8.4836912 11.8610669 10.6284251  8.4764678
42  6.6384264  8.5506709  6.8803555  6.7552191  9.6315214  8.6318922  6.2801739
43  7.6491265  9.5976221  7.9117652  7.8549386 10.6409903  9.7014699  7.3171233
44  8.1038109 10.0929870  8.3911764  8.4658170 11.0832341 10.2328541  7.8064853
45  7.2505521  8.9263780  7.3902953  6.6864901 10.1612575  8.8617680  6.7884623
46  8.0778876  9.9033081  8.2803768  7.8646195 11.0553817  9.9157984  7.6742377
47  5.8721369  7.8746308  6.1673667  6.4055121  8.8488897  8.0404783  5.5888099
48  7.1162454  9.1438336  7.4311600  7.7236798 10.0686113  9.3334184  6.8634964
49  7.9980659  9.9435728  8.2593093  8.1793764 10.9901578 10.0430799  7.6640399
50  8.4231291 10.4560324  8.7427334  9.0145244 11.3649265 10.6483963  8.1771934
51  7.6627198  9.4033827  7.8288101  7.2388466 10.6069162  9.3692486  7.2234269
52  7.7601498  9.7437091  8.0437487  8.1088497 10.7425887  9.8793688  7.4574758
53  8.0682814  9.9843831  8.3138482  8.1392992 11.0618098 10.0597020  7.7140196
54  7.2437960  9.1909315  7.5053197  7.4608341 10.2360428  9.2958709  6.9105034
55  9.6665475 11.5531348  9.8988556  9.5936968 12.6583770 11.5988869  9.2958709
56 10.5294728 12.5225568 10.8202107 10.8434442 13.5037473 12.6583770 10.2360428
57  7.9029325  9.6345114  8.0658850  7.4490673 10.8434442  9.5936968  7.4608341
58  7.8300369  9.7878259  8.0981128  8.0658850 10.8202107  9.8988556  7.5053197
59  9.5300497 11.4672808  9.7878259  9.6345114 12.5225568 11.5531348  9.1909315
60  7.5466670  9.5300497  7.8300369  7.9029325 10.5294728  9.6665475  7.2437960
            8          9         10         11         12         13         14
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9   0.9106844                                                                  
10  1.6789424  2.4280826                                                       
11  1.8726066  1.1424704  3.5196335                                            
12  0.3582196  0.5618936  1.9906660  1.5336318                                 
13  1.8175452  0.9626227  3.0718013  1.3149793  1.4996317                      
14  2.3899957  1.8979505  2.9152844  2.6223387  2.2200523  1.3185809           
15  0.9247768  1.7900660  0.8408262  2.7970905  1.2738803  2.5952838  2.8026015
16  2.2382215  2.8904165  0.6398904  4.0172492  2.5173511  3.4031523  2.9948555
17  0.9753122  0.3571355  2.6120912  0.9077354  0.6277497  1.1758739  2.2345680
18  0.5570653  0.4876748  1.9416096  1.6148116  0.3497166  1.2804532  1.8773256
19  1.4339897  1.4281115  1.7124251  2.5193993  1.4250945  1.5799867  1.2188645
20  1.7743121  2.6849965  1.2601329  3.5440219  2.1277324  3.5634476  3.8191788
21  1.8940443  2.6391567  2.4208248  3.0915159  2.1303803  3.6016947  4.2797684
22  1.5190670  0.6433896  2.8640171  1.1407989  1.1901835  0.3224294  1.4983561
23  1.0476033  1.5172435  2.3972685  1.8775583  1.1133158  2.4608585  3.3310681
24  0.8608878  1.7680640  1.3032748  2.6276188  1.2073266  2.6738209  3.0969259
25  0.9133393  1.0013906  2.5410617  1.3013905  0.7742412  1.9023854  2.8863124
26  2.9130250  3.7779454  2.6361981  4.3896592  3.2248942  4.7234883  5.1614878
27  1.0850400  1.8020317  0.6260511  2.8985802  1.3762071  2.4727580  2.4718333
28  1.6860767  1.6210681  1.8617476  2.6767687  1.6643453  1.6409243  1.0553625
29  2.2382676  1.3397215  3.5591223  1.2689806  1.8997334  0.4909240  1.6008469
30  0.9751795  1.0939615  1.5694515  2.2301437  0.9855918  1.5142145  1.5432099
31  7.5233441  7.3085968  6.9626771  8.0702549  7.4897603  6.7553071  5.4623014
32  7.8600612  7.4206178  7.7207494  7.9358388  7.7359244  6.6674874  5.5291048
33  6.8146348  6.5982170  6.2861057  7.3682640  6.7790451  6.0536382  4.7563032
34  7.9352091  7.8248375  7.1753116  8.6715000  7.9436564  7.3646607  6.0493525
35 10.5302304 10.5052264  9.5719468 11.4000034 10.5751902 10.1026192  8.7841240
36  9.2147514  8.9384969  8.7165950  9.6217720  9.1588373  8.3126760  7.0576968
37  8.8816495  8.7436266  8.1432867  9.5589671  8.8805154  8.2467328  6.9385311
38  9.5410051  9.3107895  8.9504761 10.0369359  9.5039451  8.7234175  7.4475050
39  7.9261538  7.5630265  7.6316710  8.1680809  7.8334153  6.8728107  5.6658006
40 10.1692536 10.0318000  9.4023858 10.8381887 10.1697476  9.5246681  8.2198862
41  9.1665708  9.1159637  8.2743137  9.9993146  9.2001435  8.6998697  7.3815889
42  7.0647715  6.8515586  6.5193948  7.6208037  7.0309626  6.3060850  5.0095025
43  8.1205167  7.8628208  7.6184039  8.5763683  8.0706908  7.2633107  5.9920494
44  8.6333710  8.3171415  8.2260625  8.9646887  8.5606221  7.6610399  6.4262338
45  7.4364203  7.4528328  6.4802689  8.3964782  7.4935756  7.1238362  5.8120981
46  8.4054794  8.2884328  7.6433424  9.1253366  8.4119952  7.8163261  6.5030317
47  6.4293287  6.0852375  6.1608312  6.7368539  6.3416866  5.4298818  4.1923118
48  7.7162454  7.3277907  7.4791201  7.9069231  7.6128654  6.6180576  5.4298818
49  8.4649392  8.2117509  7.9439884  8.9258140  8.4173979  7.6128654  6.3416866
50  9.0310909  8.6340625  8.7709254  9.1855143  8.9258140  7.9069231  6.7368539
51  7.9073327  7.8690287  7.0264234  8.7709254  7.9439884  7.4791201  6.1608312
52  8.2816190  7.9736196  7.8690287  8.6340625  8.2117509  7.3277907  6.0852375
53  8.4975044  8.2816190  7.9073327  9.0310909  8.4649392  7.7162454  6.4293287
54  7.7140196  7.4574758  7.2234269  8.1771934  7.6640399  6.8634964  5.5888099
55 10.0597020  9.8793688  9.3692486 10.6483963 10.0430799  9.3334184  8.0404783
56 11.0618098 10.7425887 10.6069162 11.3649265 10.9901578 10.0686113  8.8488897
57  8.1392992  8.1088497  7.2388466  9.0145244  8.1793764  7.7236798  6.4055121
58  8.3138482  8.0437487  7.8288101  8.7427334  8.2593093  7.4311600  6.1673667
59  9.9843831  9.7437091  9.4033827 10.4560324  9.9435728  9.1438336  7.8746308
60  8.0682814  7.7601498  7.6627198  8.4231291  7.9980659  7.1162454  5.8721369
           15         16         17         18         19         20         21
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16  1.4681739                                                                  
17  1.8988971  3.1186225                                                       
18  1.3372762  2.4059340  0.7383108                                            
19  1.6140158  1.8895334  1.7701000  1.1018198                                 
20  1.0208893  1.8044579  2.7055883  2.2837445  2.6177477                      
21  1.7679418  3.0379563  2.4832502  2.4361897  3.2260814  1.3307756           
22  2.3330151  3.2400886  0.8587572  0.9999616  1.4980429  3.2803757  3.2811663
23  1.5581885  3.0259369  1.2996156  1.4615612  2.4763214  1.8748393  1.2189622
24  0.5072136  1.9422975  1.7791571  1.3972928  1.9708911  0.9265957  1.2893708
25  1.7213946  3.1302611  0.7268045  1.1014356  2.1972084  2.2956603  1.8156680
26  2.3718333  3.1033801  3.6928116  3.4671673  3.9857414  1.4052960  1.3443037
27  0.4714811  1.1533791  1.9920373  1.3156844  1.2549700  1.3812876  2.2394163
28  1.8413555  1.9623817  1.9712454  1.3326345  0.2534789  2.8328680  3.4760797
29  3.0571533  3.8937505  1.4600060  1.7255471  2.0589097  4.0046981  3.9407776
30  1.2674546  1.8976802  1.4065840  0.6883396  0.4588460  2.2881843  2.7904469
31  7.4430008  6.5084397  7.6608679  7.1453596  6.0902957  8.2199517  9.2044465
32  8.0138362  7.3959875  7.7449591  7.3877453  6.4701772  8.9232851  9.6961191
33  6.7477020  5.8493334  6.9507662  6.4344765  5.3811909  7.5403136  8.5061591
34  7.7427133  6.6607493  8.1814527  7.6088589  6.5211695  8.4331246  9.5099638
35 10.2277525  8.9972187 10.8622578 10.2516778  9.1515286 10.8014110 11.9738991
36  9.1778897  8.2677872  9.2848382  8.8110529  7.7813241  9.9721126 10.9331129
37  8.7058017  7.6286826  9.0993062  8.5428015  7.4613954  9.4012789 10.4734838
38  9.4529763  8.4730464  9.6610786  9.1586178  8.1076717 10.2101413 11.2168551
39  7.9961817  7.2557733  7.8998264  7.4836988  6.5077327  8.8624859  9.7174764
40  9.9809394  8.8744366 10.3872779  9.8321568  8.7502138 10.6575714 11.7477216
41  8.9005550  7.7191573  9.4730977  8.8729203  7.7751769  9.5178341 10.6575714
42  6.9901394  6.0745268  7.2041680  6.6866363  5.6316146  7.7751769  8.7502138
43  8.0764834  7.1763386  8.2114878  7.7237348  6.6866363  8.8729203  9.8321568
44  8.6448258  7.8086530  8.6594672  8.2114878  7.2041680  9.4730977 10.3872779
45  7.1251140  5.9182920  7.8086530  7.1763386  6.0745268  7.7191573  8.8744366
46  8.2138083  7.1251140  8.6448258  8.0764834  6.9901394  8.9005550  9.9809394
47  6.5030317  5.8120981  6.4262338  5.9920494  5.0095025  7.3815889  8.2198862
48  7.8163261  7.1238362  7.6610399  7.2633107  6.3060850  8.6998697  9.5246681
49  8.4119952  7.4935756  8.5606221  8.0706908  7.0309626  9.2001435 10.1697476
50  9.1253366  8.3964782  8.9646887  8.5763683  7.6208037  9.9993146 10.8381887
51  7.6433424  6.4802689  8.2260625  7.6184039  6.5193948  8.2743137  9.4023858
52  8.2884328  7.4528328  8.3171415  7.8628208  6.8515586  9.1159637 10.0318000
53  8.4054794  7.4364203  8.6333710  8.1205167  7.0647715  9.1665708 10.1692536
54  7.6742377  6.7884623  7.8064853  7.3171233  6.2801739  8.4764678  9.4285617
55  9.9157984  8.8617680 10.2328541  9.7014699  8.6318922 10.6284251 11.6836609
56 11.0553817 10.1612575 11.0832341 10.6409903  9.6315214 11.8610669 12.8049224
57  7.8646195  6.6864901  8.4658170  7.8549386  6.7552191  8.4836912  9.6212425
58  8.2803768  7.3902953  8.3911764  7.9117652  6.8803555  9.0823535 10.0340166
59  9.9033081  8.9263780 10.0929870  9.5976221  8.5506709 10.6629730 11.6665394
60  8.0778876  7.2505521  8.1038109  7.6491265  6.6384264  8.9084667  9.8201613
           22         23         24         25         26         27         28
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23  2.1387359                                                                  
24  2.3792040  1.1245372                                                       
25  1.5838179  0.5993442  1.4190561                                            
26  4.4148523  2.5160417  2.0863565  3.0912299                                 
27  2.2509353  1.9311040  0.9682760  1.9802997  2.7761716                      
28  1.6068722  2.7265060  2.2150170  2.4329214  4.2118897  1.4570469           
29  0.7255872  2.7569039  3.0991554  2.1690776  5.1154830  2.9557852  2.1008430
30  1.3433100  2.0180560  1.5615952  1.7597532  3.6182920  1.0044850  0.7110698
31  6.9601642  8.5664075  7.9159557  8.2398099  9.5922271  6.9735331  5.8399458
32  6.9358035  8.8491514  8.4286219  8.4147428 10.3284396  7.5708061  6.2201047
33  6.2545726  7.8569967  7.2170653  7.5287523  8.9199523  6.2793113  5.1304938
34  7.5400529  8.9826410  8.2344728  8.7102946  9.7639114  7.2715739  6.2793113
35 10.2621256 11.5701322 10.7317069 11.3485159 12.0506012  9.7639114  8.9199523
36  8.5424138 10.2506704  9.6437436  9.8943702 11.3485159  8.7102946  7.5287523
37  8.4351057  9.9292406  9.1959436  9.6437436 10.7317069  8.2344728  7.2170653
38  8.9412677 10.5834963  9.9292406 10.2506704 11.5701322  8.9826410  7.8569967
39  7.1216614  8.9412677  8.4351057  8.5424138 10.2621256  7.5400529  6.2545726
40  9.7174764 11.2168551 10.4734838 10.9331129 11.9738991  9.5099638  8.5061591
41  8.8624859 10.2101413  9.4012789  9.9721126 10.8014110  8.4331246  7.5403136
42  6.5077327  8.1076717  7.4613954  7.7813241  9.1515286  6.5211695  5.3811909
43  7.4836988  9.1586178  8.5428015  8.8110529 10.2516778  7.6088589  6.4344765
44  7.8998264  9.6610786  9.0993062  9.2848382 10.8622578  8.1814527  6.9507662
45  7.2557733  8.4730464  7.6286826  8.2677872  8.9972187  6.6607493  5.8493334
46  7.9961817  9.4529763  8.7058017  9.1778897 10.2277525  7.7427133  6.7477020
47  5.6658006  7.4475050  6.9385311  7.0576968  8.7841240  6.0493525  4.7563032
48  6.8728107  8.7234175  8.2467328  8.3126760 10.1026192  7.3646607  6.0536382
49  7.8334153  9.5039451  8.8805154  9.1588373 10.5751902  7.9436564  6.7790451
50  8.1680809 10.0369359  9.5589671  9.6217720 11.4000034  8.6715000  7.3682640
51  7.6316710  8.9504761  8.1432867  8.7165950  9.5719468  7.1753116  6.2861057
52  7.5630265  9.3107895  8.7436266  8.9384969 10.5052264  7.8248375  6.5982170
53  7.9261538  9.5410051  8.8816495  9.2147514 10.5302304  7.9352091  6.8146348
54  7.0816466  8.7519671  8.1391913  8.4047126  9.8579551  7.2071139  6.0279625
55  9.5385200 11.1063022 10.4019132 10.7997205 11.9651421  9.4443221  8.3843681
56 10.3145015 12.0905034 11.5159227 11.7130972 13.2400927 10.5893986  9.3782178
57  7.8750213  9.1814434  8.3656609  8.9523808  9.7730395  7.3974466  6.5229893
58  7.6559092  9.3501544  8.7446589  8.9965325 10.4628876  7.8133949  6.6278217
59  9.3659626 11.0258532 10.3785774 10.6879136 12.0234147  9.4331582  8.2995677
60  7.3506631  9.0972202  8.5321770  8.7248099 10.2988755  7.6147061  6.3850658
           29         30         31         32         33         34         35
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30  2.0048240                                                                  
31  6.9117293  6.5489500                                                       
32  6.6808698  6.9117293  2.0048240                                            
33  6.2201047  5.8399458  0.7110698  2.1008430                                 
34  7.5708061  6.9735331  1.0044850  2.9557852  1.4570469                      
35 10.3284396  9.5922271  3.6182920  5.1154830  4.2118897  2.7761716           
36  8.4147428  8.2398099  1.7597532  2.1690776  2.4329214  1.9802997  3.0912299
37  8.4286219  7.9159557  1.5615952  3.0991554  2.2150170  0.9682760  2.0863565
38  8.8491514  8.5664075  2.0180560  2.7569039  2.7265060  1.9311040  2.5160417
39  6.9358035  6.9601642  1.3433100  0.7255872  1.6068722  2.2509353  4.4148523
40  9.6961191  9.2044465  2.7904469  3.9407776  3.4760797  2.2394163  1.3443037
41  8.9232851  8.2199517  2.2881843  4.0046981  2.8328680  1.3812876  1.4052960
42  6.4701772  6.0902957  0.4588460  2.0589097  0.2534789  1.2549700  3.9857414
43  7.3877453  7.1453596  0.6883396  1.7255471  1.3326345  1.3156844  3.4671673
44  7.7449591  7.6608679  1.4065840  1.4600060  1.9712454  1.9920373  3.6928116
45  7.3959875  6.5084397  1.8976802  3.8937505  1.9623817  1.1533791  3.1033801
46  8.0138362  7.4430008  1.2674546  3.0571533  1.8413555  0.4714811  2.3718333
47  5.5291048  5.4623014  1.5432099  1.6008469  1.0553625  2.4718333  5.1614878
48  6.6674874  6.7553071  1.5142145  0.4909240  1.6409243  2.4727580  4.7234883
49  7.7359244  7.4897603  0.9855918  1.8997334  1.6643453  1.3762071  3.2248942
50  7.9358388  8.0702549  2.2301437  1.2689806  2.6767687  2.8985802  4.3896592
51  7.7207494  6.9626771  1.5694515  3.5591223  1.8617476  0.6260511  2.6361981
52  7.4206178  7.3085968  1.0939615  1.3397215  1.6210681  1.8020317  3.7779454
53  7.8600612  7.5233441  0.9751795  2.2382676  1.6860767  1.0850400  2.9130250
54  6.9937699  6.7388753  0.3948405  1.6566967  0.9391684  1.3008669  3.7287473
55  9.4826963  9.0889753  2.5785543  3.5257448  3.2847544  2.2029655  1.8414842
56 10.1309362 10.0886985  3.6532823  3.5240729  4.3208885  3.7338807  3.5456707
57  7.9664896  7.1972198  1.7367796  3.7011765  2.0813448  0.7455015  2.3971987
58  7.5461208  7.3388704  0.9082306  1.6856754  1.5429528  1.4707526  3.4474465
59  9.2600077  9.0094907  2.4641987  3.0226367  3.1701753  2.3662828  2.5248510
60  7.2115489  7.0953753  0.9600035  1.2602133  1.4321096  1.7628390  3.8890825
           36         37         38         39         40         41         42
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37  1.4190561                                                                  
38  0.5993442  1.1245372                                                       
39  1.5838179  2.3792040  2.1387359                                            
40  1.8156680  1.2893708  1.2189622  3.2811663                                 
41  2.2956603  0.9265957  1.8748393  3.2803757  1.3307756                      
42  2.1972084  1.9708911  2.4763214  1.4980429  3.2260814  2.6177477           
43  1.1014356  1.3972928  1.4615612  0.9999616  2.4361897  2.2837445  1.1018198
44  0.7268045  1.7791571  1.2996156  0.8587572  2.4832502  2.7055883  1.7701000
45  3.1302611  1.9422975  3.0259369  3.2400886  3.0379563  1.8044579  1.8895334
46  1.7213946  0.5072136  1.5581885  2.3330151  1.7679418  1.0208893  1.6140158
47  2.8863124  3.0969259  3.3310681  1.4983561  4.2797684  3.8191788  1.2188645
48  1.9023854  2.6738209  2.4608585  0.3224294  3.6016947  3.5634476  1.5799867
49  0.7742412  1.2073266  1.1133158  1.1901835  2.1303803  2.1277324  1.4250945
50  1.3013905  2.6276188  1.8775583  1.1407989  3.0915159  3.5440219  2.5193993
51  2.5410617  1.3032748  2.3972685  2.8640171  2.4208248  1.2601329  1.7124251
52  1.0013906  1.7680640  1.5172435  0.6433896  2.6391567  2.6849965  1.4281115
53  0.9133393  0.8608878  1.0476033  1.5190670  1.8940443  1.7743121  1.4339897
54  1.5046976  1.6425086  1.8600106  0.9671882  2.7776080  2.4652548  0.7233893
55  1.3675825  1.2397936  0.7701767  2.8948263  0.4974327  1.6022291  3.0313532
56  1.8935602  2.9046131  1.8064918  3.1968461  2.3081969  3.4869013  4.0888023
57  2.5379702  1.2178177  2.3370336  2.9943654  2.2491637  1.0363536  1.9190384
58  0.9010387  1.4139556  1.3111218  0.9700145  2.3552310  2.3265106  1.3167543
59  0.8774822  1.5041278  0.4533357  2.4607241  1.1805592  2.1343190  2.9214153
60  1.2053176  1.8437244  1.6997918  0.5361344  2.7891620  2.7446045  1.2525116
           43         44         45         46         47         48         49
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37                                                                             
38                                                                             
39                                                                             
40                                                                             
41                                                                             
42                                                                             
43                                                                             
44  0.7383108                                                                  
45  2.4059340  3.1186225                                                       
46  1.3372762  1.8988971  1.4681739                                            
47  1.8773256  2.2345680  2.9948555  2.8026015                                 
48  1.2804532  1.1758739  3.4031523  2.5952838  1.3185809                      
49  0.3497166  0.6277497  2.5173511  1.2738803  2.2200523  1.4996317           
50  1.6148116  0.9077354  4.0172492  2.7970905  2.6223387  1.3149793  1.5336318
51  1.9416096  2.6120912  0.6398904  0.8408262  2.9152844  3.0718013  1.9906660
52  0.4876748  0.3571355  2.8904165  1.7900660  1.8979505  0.9626227  0.5618936
53  0.5570653  0.9753122  2.2382215  0.9247768  2.3899957  1.8175452  0.3582196
54  0.4066912  1.0487779  2.2770252  1.4602650  1.5045964  1.1719527  0.7543548
55  2.1288005  2.0666693  3.1440951  1.7470048  4.0028915  3.2172343  1.7975006
56  2.9885301  2.4295723  4.8303246  3.3621828  4.6573521  3.4653075  2.6677996
57  2.0409408  2.6767710  0.7895531  0.8167187  3.1307782  3.2182096  2.0494964
58  0.2198923  0.5352551  2.5864007  1.4311859  2.0215337  1.2760728  0.2261701
59  1.8825816  1.6024493  3.4370786  1.9711585  3.7330139  2.7782312  1.5329628
60  0.4697682  0.5671292  2.8119613  1.8070395  1.6864195  0.8346688  0.6676523
           50         51         52         53         54         55         56
2                                                                              
3                                                                              
4                                                                              
5                                                                              
6                                                                              
7                                                                              
8                                                                              
9                                                                              
10                                                                             
11                                                                             
12                                                                             
13                                                                             
14                                                                             
15                                                                             
16                                                                             
17                                                                             
18                                                                             
19                                                                             
20                                                                             
21                                                                             
22                                                                             
23                                                                             
24                                                                             
25                                                                             
26                                                                             
27                                                                             
28                                                                             
29                                                                             
30                                                                             
31                                                                             
32                                                                             
33                                                                             
34                                                                             
35                                                                             
36                                                                             
37                                                                             
38                                                                             
39                                                                             
40                                                                             
41                                                                             
42                                                                             
43                                                                             
44                                                                             
45                                                                             
46                                                                             
47                                                                             
48                                                                             
49                                                                             
50                                                                             
51  3.5196335                                                                  
52  1.1424704  2.4280826                                                       
53  1.8726066  1.6789424  0.9106844                                            
54  1.8411853  1.9030957  0.7156950  0.8854744                                 
55  2.6166014  2.5068165  2.2620380  1.6235805  2.5018128                      
56  2.2633360  4.1980503  2.7801921  2.7596166  3.3850968  1.8989655           
57  3.5830343  0.2461708  2.5213912  1.7174717  2.0462745  2.3744746  4.1218879
58  1.4318016  2.0951129  0.3614173  0.5534649  0.6064541  2.0145093  2.7788650
59  1.9989353  2.8017203  1.8719329  1.4982112  2.2865998  0.6835424  1.4011302
60  1.2763566  2.3856229  0.2137126  0.9845448  0.5668436  2.4308853  2.9935786
           57         58         59
2                                  
3                                  
4                                  
5                                  
6                                  
7                                  
8                                  
9                                  
10                                 
11                                 
12                                 
13                                 
14                                 
15                                 
16                                 
17                                 
18                                 
19                                 
20                                 
21                                 
22                                 
23                                 
24                                 
25                                 
26                                 
27                                 
28                                 
29                                 
30                                 
31                                 
32                                 
33                                 
34                                 
35                                 
36                                 
37                                 
38                                 
39                                 
40                                 
41                                 
42                                 
43                                 
44                                 
45                                 
46                                 
47                                 
48                                 
49                                 
50                                 
51                                 
52                                 
53                                 
54                                 
55                                 
56                                 
57                                 
58  2.1760314                      
59  2.7208939  1.7141182           
60  2.4981417  0.4423996  2.0693232</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hc<span class="ot">&lt;-</span><span class="fu">hclust</span>(<span class="fu">dist</span>(x))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = dist(x))

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<p>plotting hc</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">9</span>, <span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>to get the cluster membership vector, we need to cut the tree at a given height of our choosing.</p>
<p>The function to do this is ‘cutree()’ h cuts at a height, k cuts into that number of clusters</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cutree</span>(hc, <span class="at">h=</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q Plot x, colored with the hclust results</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k=</span><span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>grps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#Principal Component Analysis (PCA)</p>
<p>PCA of food UK data</p>
<p>data import</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url,<span class="at">row.names=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#PCA</p>
<p>function to do PCA in base R is prcomp() - foods and columns and countries as rows the table needs to be transposed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 4.189e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>],pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">'PCA1 (67.4%)'</span>, <span class="at">ylab=</span><span class="st">'PCA2 (29%)'</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">'red'</span>,<span class="st">'green'</span>,<span class="st">'orange'</span>,<span class="st">'blue'</span>), <span class="at">pch=</span><span class="dv">15</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q1. How many rows and columns are in your new data frame named x? What R functions could you use to answer this questions?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Checking the data - view the first section of the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               England Wales Scotland N.Ireland
Cheese             105   103      103        66
Carcass_meat       245   227      242       267
Other_meat         685   803      750       586
Fish               147   160      122        93
Fats_and_oils      193   235      184       209
Sugars             156   175      147       139</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q2. Which approach to solving the ‘row-names problem’ mentioned above do you prefer and why? Is one approach more robust than another under certain circumstances?</p>
</blockquote>
<p>The method done during the read.csv step is simplier and allows for the merging of two steps rather than having to do a second step to make the data frame four rows</p>
<blockquote class="blockquote">
<p>Q3. Changing what optional argument in the above barplot() function results in the following plot?</p>
</blockquote>
<p>Changing beside from true to false will yeild a stacked bar plot based on country</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside=</span>T, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q5. Generating all pairwise plots may help somewhat. Can you make sense of the following code and resulting figure? What does it mean if a given point lies on the diagonal for a given plot?</p>
</blockquote>
<p>The pairs plot shows similarity between the two countries where if the frequency a food is eaten is the same between two countries, it will lie on the diagonal</p>
<p>one useful plot is a pairs plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">17</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q6.What is the main differences between N. Ireland and the other countries of the UK in terms of this data-set?</p>
</blockquote>
<p>The greatest variation in the data when comparing N.Ireland to the other countries comes from the ammount of Fresh potatoes, fresh fruit and acoholic drinks being either noticably higher or lower in frequency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span><span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3       PC4
Standard deviation     324.1502 212.7478 73.87622 4.189e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.000e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.000e+00</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q7. Complete the code below to generate a plot of PC1 vs PC2. The second line adds text labels over the data points.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="fu">colnames</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q8. Customize your plot so that the colors of the country names match the colors in our UK and Ireland map and table at start of this document.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">270</span>,<span class="dv">500</span>))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="fu">colnames</span>(x),<span class="at">col=</span><span class="fu">c</span>(<span class="st">'orange'</span>,<span class="st">'red'</span>,<span class="st">'blue'</span>,<span class="st">'green'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">round</span>( pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sum</span>(pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span> )</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67 29  4  0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">summary</span>(pca)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>z<span class="sc">$</span>importance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             PC1       PC2      PC3          PC4
Standard deviation     324.15019 212.74780 73.87622 4.188568e-14
Proportion of Variance   0.67444   0.29052  0.03503 0.000000e+00
Cumulative Proportion    0.67444   0.96497  1.00000 1.000000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(v, <span class="at">xlab=</span><span class="st">"Principal Component"</span>, <span class="at">ylab=</span><span class="st">"Percent Variation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="fl">0.35</span>, <span class="dv">0</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( pca<span class="sc">$</span>rotation[,<span class="dv">1</span>], <span class="at">las=</span><span class="dv">2</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<blockquote class="blockquote">
<p>Q9: Generate a similar ‘loadings plot’ for PC2. What two food groups feature prominantely and what does PC2 maninly tell us about?</p>
</blockquote>
<p>PC2 is mostly affected by the data for fresh potatoes and soft drinks with fresh potatoes hacing a positive loading score that pushes N.Ierland to the right while soft drinks has a high negative score that pushes it to the left of the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="fl">0.35</span>, <span class="dv">0</span>))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>( pca<span class="sc">$</span>rotation[,<span class="dv">2</span>], <span class="at">las=</span><span class="dv">2</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#making the plots in ggplot</p>
<p>Basic PCA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_lab <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(df, <span class="st">"Country"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_lab) <span class="sc">+</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2, <span class="at">col=</span>Country) <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Making the PCA look nicer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_lab) <span class="sc">+</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2, <span class="at">col=</span>Country, <span class="at">label=</span>Country) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">hjust=</span><span class="dv">1</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">300</span>,<span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"PC1 (67.4%)"</span>) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"PC2 (28%)"</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Basic loadings graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ld <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>rotation)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>ld_lab <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(ld, <span class="st">"Food"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ld_lab) <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, Food) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Loadings graph that looks nicer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ld_lab) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, <span class="fu">reorder</span>(Food, PC1), <span class="at">bg=</span>PC1) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"PC1 Loadings/Contributions"</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Food Group"</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">"purple"</span>, <span class="at">mid=</span><span class="st">"gray"</span>, <span class="at">high=</span><span class="st">"darkgreen"</span>, <span class="at">guide=</span><span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>biplot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>#PCA of RNA-sqe Data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>url2 <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/expression-CSV"</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>rna.data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url2, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       wt1 wt2  wt3  wt4 wt5 ko1 ko2 ko3 ko4 ko5
gene1  439 458  408  429 420  90  88  86  90  93
gene2  219 200  204  210 187 427 423 434 433 426
gene3 1006 989 1030 1017 973 252 237 238 226 210
gene4  783 792  829  856 760 849 856 835 885 894
gene5  181 249  204  244 225 277 305 272 270 279
gene6  460 502  491  491 493 612 594 577 618 638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(rna.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q10: How many genes and samples are in this data set?</p>
</blockquote>
<p>there are 100 genes and 10 samples</p>
<p>RNA seq PCA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(rna.data), <span class="at">scale=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">"PC1"</span>, <span class="at">ylab=</span><span class="st">"PC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     9.6237 1.5198 1.05787 1.05203 0.88062 0.82545 0.80111
Proportion of Variance 0.9262 0.0231 0.01119 0.01107 0.00775 0.00681 0.00642
Cumulative Proportion  0.9262 0.9493 0.96045 0.97152 0.97928 0.98609 0.99251
                           PC8     PC9      PC10
Standard deviation     0.62065 0.60342 3.348e-15
Proportion of Variance 0.00385 0.00364 0.000e+00
Cumulative Proportion  0.99636 1.00000 1.000e+00</code></pre>
</div>
</div>
<p>scree plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca, <span class="at">main=</span><span class="st">"Quick scree plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>scree plot made with info from prcomp function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>pca.var <span class="ot">&lt;-</span> pca<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>pca.var.per <span class="ot">&lt;-</span> <span class="fu">round</span>(pca.var<span class="sc">/</span><span class="fu">sum</span>(pca.var)<span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>pca.var.per</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 92.6  2.3  1.1  1.1  0.8  0.7  0.6  0.4  0.4  0.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(pca.var.per, <span class="at">main=</span><span class="st">"Scree Plot"</span>, </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">paste0</span>(<span class="st">"PC"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Principal Component"</span>, <span class="at">ylab=</span><span class="st">"Percent Variation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A better looking pca using base R</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>colvec <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rna.data)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>colvec[<span class="fu">grep</span>(<span class="st">"wt"</span>, colvec)] <span class="ot">&lt;-</span> <span class="st">"red"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>colvec[<span class="fu">grep</span>(<span class="st">"ko"</span>, colvec)] <span class="ot">&lt;-</span> <span class="st">"blue"</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">col=</span>colvec, <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, pca.var.per[<span class="dv">1</span>], <span class="st">"%)"</span>),</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, pca.var.per[<span class="dv">2</span>], <span class="st">"%)"</span>))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span>], pca<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">labels =</span> <span class="fu">colnames</span>(rna.data), <span class="at">pos=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">5</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using ggplot to make better looking graphs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2) <span class="sc">+</span> </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>samples <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rna.data) </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>condition <span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">colnames</span>(rna.data),<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(PC1, PC2, <span class="at">label=</span>samples, <span class="at">col=</span>condition) <span class="sc">+</span> </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_label</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"PCA of RNASeq Data"</span>,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"PC1 clealy seperates wild-type from knock-out samples"</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="fu">paste0</span>(<span class="st">"PC1 ("</span>, pca.var.per[<span class="dv">1</span>], <span class="st">"%)"</span>),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">paste0</span>(<span class="st">"PC2 ("</span>, pca.var.per[<span class="dv">2</span>], <span class="st">"%)"</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption=</span><span class="st">"Class example data"</span>) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-7_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>